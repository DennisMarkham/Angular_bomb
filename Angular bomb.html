<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<style>

 @font-face {
    font-family: digital-7;
    src: url(digital-7.ttf);
}

#counter
{
	background-color: black;
	font-size: 200%;
	font-family: digital-7;
	color: red;
    border-style: outset;
    width: 40px;
    height: 30px;
    padding: 5px;
}

#counterSpan
{
	float:right;
	/*see here I just wish I could give it a font where each number has their own distinct
	territory, so they don't appear to be moving around during the countdown*/
}
</style>
</head>
<body ng-app="myApp" ng-controller="myCtrl">

<div> 



<!-- 
tricky bit of engineering here to get interface to disappear on detonation OR victory -->
<div ng-hide = "victory">
<div ng-hide = "detonated"><div id = "counter"><span id = "counterSpan">0:{{counter}}</span></div>
<br>
<br>
<button ng-click = "submitGuess(0)">red</button> 
<button ng-click = "submitGuess(1)">blue</button>
<button ng-click = "submitGuess(2)">green</button>
<!-- 
seals detonated div -->
</div>

<!-- seals victory div -->
</div>


<h1 ng-show = "detonated">Boom!</h1>
<h1 ng-show = "victory">Victory!</h1>

<a ng-show = "detonated" href = {{reload}}>Try again?</a>
<a ng-show = "victory" href = {{reload}}>Try again?</a>
<!-- this "try again" should show up whether there is victory or detonation.  But how to bind
	it to location.reload() or the Angular equivalent? -->

<!-- seals controller -->
</div>






<script>
var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope, $interval, $timeout, $location) {
  
  $scope.counter = 15;
  $scope.detonated = false;
  $scope.victory = false;
  // $scope.boom = new Audio("boom.wav");
  $scope.correct = Math.floor(Math.random() * 3);
  //this random selection of correctness seems to work, but I cna't console log it for some 
  //reason.
  $scope.reload =  $location.absUrl();

  // $scope.reload = function()
  // {
  // 	console.log("reload function firing");
  // 	$window.location.reload();
  // 	//tried to make the whole body the Angular-JS app.  Didn't hellp
  // }

  $scope.submitGuess = function(guess)
  {
  	if (guess == $scope.correct)
  	{
  		$scope.victory = true;
  	}
  	else
  	{
  		$scope.detonated = true;
  	}
  }


  $interval(function () {
      $scope.counter = $scope.counter - 1;
  }, 1000);

  $timeout(function () {
  	// $scope.boom.play();
      if ($scope.victory == false) {$scope.detonated = true;}
  }, $scope.counter * 1000)
  

});
</script>

</body>
</html>
